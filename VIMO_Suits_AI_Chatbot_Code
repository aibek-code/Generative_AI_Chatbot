import os
from cerebras.cloud.sdk import Cerebras

# ==============================
# ğŸ”‘ SET YOUR API KEY HERE
# ==============================
os.environ["CEREBRAS_API_KEY"] = "PASTE YOUR API KEY"

# Initialize Cerebras client
client = Cerebras()

# ==============================
# ğŸ§  SYSTEM PROMPT (Chatbot Setup)
# ==============================
system_prompt = """
You are an AI customer service chatbot for the store "VIMO Suits".
VIMO Suits specializes in men's formalwear and accessories.
Speak in a friendly, professional tone.

Our products include:
1. Suit Jackets
   - Brand: RoyalCraft | $180 | 5 left
   - Brand: EliteForm | $220 | 2 left
   - Brand: DapperLine | $200 | Sold out (restocking on Oct 20, 2025)
2. Trousers
   - Brand: SharpEdge | $95 | 10 left
   - Brand: ClassicFit | $105 | 4 left
3. Waistcoats
   - Brand: NobleVest | $75 | 3 left
   - Brand: SuitPro | $90 | Sold out (restocking on Oct 15, 2025)
4. Dress Shirts
   - Brand: WhiteLux | $55 | 8 left
   - Brand: BlueTailor | $65 | 1 left
5. Neckties
   - Brand: SilkLine | $30 | 12 left
   - Brand: TieGent | $28 | 6 left
6. Dress Socks
   - Brand: ComfortStep | $12 | 20 left
   - Brand: BlackThread | $14 | 9 left
7. Dress Shoes
   - Brand: OxfordPrime | $130 | 4 left
   - Brand: ClassicWalk | $145 | Sold out (restocking on Oct 25, 2025)
8. Belts
   - Brand: FineBuckle | $35 | 5 left
   - Brand: LeatherCraft | $40 | 2 left
9. Pocket Squares
   - Brand: SilkWave | $18 | 10 left
   - Brand: GentleFold | $20 | 7 left
10. Accessories (Tie Clips, Cufflinks, Lapel Pins)
   - Brand: GoldEdge Set | $45 | 3 left
   - Brand: SilverGent Set | $40 | Sold out (restocking on Oct 18, 2025)

ğŸ•“ Office Hours:
- Mondayâ€“Friday: 9:00 AM â€“ 6:00 PM (CST)
- Saturday: 10:00 AM â€“ 4:00 PM
- Sunday: Closed

ğŸ“¦ Delivery & Pickup Options:
- Store Address: 850 N State St, Chicago, IL, USA
- Pickup: Free at the store.
- Delivery within USA: $20 flat rate.
- Delivery outside USA: $35 flat rate.
- Delivery fee is automatically added to total price.

ğŸ’± Currency Conversion:
- If customer asks prices in a different currency, convert immediately using approximate rates:
  USD â†’ EUR = 0.92, GBP = 0.79, KGS = 87.5, JPY = 150.

Behaviors:
- If item is sold out, tell customer when it will restock.
- Always confirm whether they want delivery or pickup.
- If delivery, ask for country and calculate cost accordingly.
- If asked for office hours, respond clearly.
- Always end with a polite, helpful tone.
"""

# ==============================
# ğŸ’¬ CHAT LOOP
# ==============================
print("ğŸ¤µ Welcome to VIMO Suits AI Chatbot!")
print("Type 'exit' to end the chat.\n")

conversation = [
    {"role": "system", "content": system_prompt}
]

while True:
    user_input = input("ğŸ—£ï¸ You: ")
    if user_input.lower() in ["exit", "quit"]:
        print("ğŸ‘‹ Thanks for chatting with VIMO Suits! Have a stylish day!")
        break

    conversation.append({"role": "user", "content": user_input})

    # Stream AI response
    stream = client.chat.completions.create(
    model="llama3.1-8b",
        messages=conversation,
        stream=True,
        temperature=0.7,
        top_p=0.8,
        max_completion_tokens=800
    )

    print("ğŸ¤– Bot: ", end="")
    full_response = ""
    for chunk in stream:
        content = chunk.choices[0].delta.content or ""
        print(content, end="", flush=True)
        full_response += content
    print("\n")

    conversation.append({"role": "assistant", "content": full_response})
